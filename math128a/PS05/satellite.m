function uprime = satellite(t, u, r)

a = 0.012277471;
b = 1-a;

x2p = u(1) + 2*u(4) - (b * ( (u(1) + a) / ( (u(1) + a)^2 + u(3)^2 )^(3/2) ) )...
    - (a * ( (u(1) - b) / ( (u(1) - b)^2 + u(3)^2 )^(3/2) ) );

y2p = u(3) - 2*u(2) - (b * ( u(3) / ( (u(1) + a)^2 + u(3)^2 )^(3/2) ) )...
    - (a * ( u(3) / ( (u(1) - b)^2 + u(3)^2 )^(3/2) ) );

uprime = [u(2), x2p, u(4), y2p];

end